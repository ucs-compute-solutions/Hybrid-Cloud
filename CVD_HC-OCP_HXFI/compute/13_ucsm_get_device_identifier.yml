---
- name: Get Device Identifier from UCSM
  block:
    - name: Get Device Identifier 
      uri:
        url: "https://{{ inventory_hostname }}/connector/DeviceIdentifiers"
        method: GET
        headers:
          Content-Type: application/json
          ucsmcookie: "ucsm-cookie={{ hostvars['DUMMY_HOST']['ucsm_cookie'] }}"
        status_code: 200
        return_content: yes
        validate_certs: no
      register: get_device_identifier_response

    - name: Show an attribute value
      debug:
        msg: "{{ get_device_identifier_response.json[0].Id  }}"

    - name: Extract device id
      set_fact:
        #device_id_fact: "{{ get_device_identifier_response.json[0].Id }}"
        device_id: "{{ get_device_identifier_response.json[0].Id }}"
  when: device_connector_status != "Claimed"








